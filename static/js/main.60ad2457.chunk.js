(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{132:function(e,t,a){"use strict";a.r(t);a(78),a(102);var n=a(0),r=a.n(n),s=a(41),o=a.n(s),c=a(11),l=a.n(c),i=a(14),u=a(74),p=a(24),d=a(30),m=a(71),h=a(72),f="osm.reverseGeo",b=a.n(h)()({osm:void 0});function v(e){return e.osm.location}var E=Object(i.c)({osm:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:b,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t.type){case f:return e.merge({location:t.location});default:return e}},router:d.routerReducer}),y=a(31),g=a(32),w=a(76),O=a(73),A=a(75),k=a(23),S=a(1),V=a(21),_=a.n(V),j=a(33),C=new(function(){function e(){Object(y.a)(this,e)}return Object(g.a)(e,[{key:"reverseLocation",value:function(){var e=Object(j.a)(_.a.mark(function e(t,a){return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",fetch("https://nominatim.openstreetmap.org/reverse?format=json&lat="+t+"&lon="+a+"&zoom=18&addressdetails=1").then(function(e){return e.json()}));case 1:case"end":return e.stop()}},e,this)}));return function(t,a){return e.apply(this,arguments)}}()}]),e}());a(130);var G=function(e){function t(e){var a;Object(y.a)(this,t),(a=Object(w.a)(this,Object(O.a)(t).call(this,e))).fetchContacts=a.fetchContacts.bind(Object(k.a)(Object(k.a)(a)));var n=new URLSearchParams(window.location.search);return a.state={activePanel:"home",fetchedUser:null,email:"",pieces:1,accessDeclined:!1,address:"",baseAddress:"",location:null,platform:n.get("vk_platform")},a}return Object(A.a)(t,e),Object(g.a)(t,[{key:"componentDidMount",value:function(){var e=this;l.a.subscribe(function(t){switch(console.log(t.detail.type),t.detail.type){case"VKWebAppGetUserInfoResult":var a=t.detail.data,n="";a.country&&(n=a.country.title),a.city&&(n+=", "+a.city.title),e.setState({fetchedUser:a,baseAddress:n,address:n});break;case"VKWebAppGetEmailResult":e.setState({email:t.detail.data.email});break;case"VKWebAppGetPhoneNumberResult":e.setState({phone:t.detail.data.phone_number});break;case"VKWebAppGetPersonalCardResult":var r=t.detail.data.address;e.setState({phone:t.detail.data.phone,email:t.detail.data.email,address:r.country.name+", "+r.city.name+", "+r.specified_address});break;case"VKWebAppGeodataResult":var s=t.detail.data;s.available&&e.props.dispatch((o=s.lat,c=s.long,function(){var e=Object(j.a)(_.a.mark(function e(t,a){var n;return _.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C.reverseLocation(o,c);case 3:n=e.sent,t({type:f,location:n}),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0);case 10:case"end":return e.stop()}},e,this,[[0,7]])}));return function(t,a){return e.apply(this,arguments)}}()));break;case"VKWebAppGetPersonalCardFailed":case"VKWebAppSetViewSettingsFailed":e.setState({accessDeclined:!0})}var o,c}),l.a.send("VKWebAppGetUserInfo",{})}},{key:"fetchContacts",value:function(e){if("mobile_android"===this.state.platform||"mobile_iphone"===this.state.platform)this.state.accessDeclined||p.b.send("VKWebAppGetPersonalCard",{type:["phone","email","address"]});else switch(e){case"address":void 0===this.props.location&&l.a.send("VKWebAppGetGeodata",{});break;case"email":l.a.send("VKWebAppGetEmail",{});break;case"phone":l.a.send("VKWebAppGetPhoneNumber",{})}}},{key:"render",value:function(){var e=this,t=this.state.fetchedUser,a=this.state.email,n=this.state.phone,s=this.state.address,o=this.state.baseAddress,c=this.props.location;return r.a.createElement(S.View,{activePanel:"main"},r.a.createElement(S.Panel,{id:"main"},r.a.createElement(S.PanelHeader,null,"Order"),r.a.createElement(S.Group,{title:"Order detail"},r.a.createElement(S.Cell,{description:r.a.createElement("div",null,r.a.createElement("span",{style:{color:"#000"}},"US 125.3$"),r.a.createElement("span",null," / piece")),before:r.a.createElement(S.Avatar,{type:"app",size:80,src:"https://i1.proskater.ru/images/b2images/1220/23082018-7644-007_1.jpg"})},"Gant Apollo Blue")),r.a.createElement(S.Group,{title:"Pieces"},r.a.createElement(S.Div,null,r.a.createElement(S.Slider,{top:this.state.pieces,min:1,step:1,max:10,value:Number(this.state.pieces),onChange:function(t){return e.setState({pieces:t})}})),r.a.createElement(S.Div,{style:{display:"flex"}},r.a.createElement(S.Div,{style:{color:"#909499",flexGrow:2}},"Shipping Charges 2$"),r.a.createElement(S.Div,{style:{color:"#909499",flexGrow:2,textAlign:"right"}},r.a.createElement("span",{style:{color:"#000"}},"US ",2*this.state.pieces,".00$")," via ups"))),r.a.createElement(S.Group,{title:"Shipping Address"},r.a.createElement(S.FormLayout,null,r.a.createElement(S.Input,{top:"Name",defaultValue:t?t.first_name+" "+t.last_name:""}),r.a.createElement(S.Input,{type:"email",top:"E-mail",onChange:function(t){return e.setState({email:t.target.value})},onClick:function(t){t.target.value||e.fetchContacts("email")},placeholder:"you@mail.com",defaultValue:a}),r.a.createElement(S.Input,{type:"phone",top:"Phone number",onChange:function(t){return e.setState({email:t.target.value})},onClick:function(t){t.target.value||e.fetchContacts("phone")},placeholder:"+7 (999) 057689",defaultValue:n}),r.a.createElement(S.Input,{type:"text",top:"Address",onChange:function(t){return e.setState({address:t.target.value})},onClick:function(t){t.target.value&&t.target.value!==o||e.fetchContacts("address")},placeholder:"USA, New York, 85 10th Ave",defaultValue:c?c.display_name:s}),r.a.createElement(S.Textarea,{top:"Message to seller"}),r.a.createElement(S.Button,{size:"xl"},"Pay")))))}}]),t}(r.a.Component);var x=Object(p.b)(function(e){return{location:v(e)}})(G);l.a.send("VKWebAppInit",{});var K=Object(u.a)({hashType:"noslash"}),P=Object(i.d)(E,window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__(),Object(i.a)(m.a,Object(d.routerMiddleware)(K),function(e){return function(e){return function(t){return console.log("dispatching",t),e(t)}}}));o.a.render(r.a.createElement(p.a,{store:P},r.a.createElement(x,null)),document.getElementById("root"))},77:function(e,t,a){e.exports=a(132)}},[[77,2,1]]]);
//# sourceMappingURL=main.60ad2457.chunk.js.map